{
  "variants": [
    {
      "id": "decorator-patterns",
      "description": "Add decorator examples for temporal correlation analysis (virtual threads, GC, safepoints, locks, I/O)",
      "modifications": {
        "customExamples": "CORE QUERY EXAMPLES:\n\nQ: \"top allocating classes\"\nA: {\"query\": \"events/jdk.ObjectAllocationSample | groupBy(objectClass/name, agg=sum, value=weight) | top(10, by=sum)\", \"explanation\": \"Groups allocations by class\", \"confidence\": 0.95}\n\nQ: \"which monitors have the most contention\"\nA: {\"query\": \"events/jdk.JavaMonitorEnter | groupBy(monitorClass/name) | top(10, by=count)\", \"explanation\": \"Groups monitor enter events by class\", \"confidence\": 0.95}\n\nQ: \"show file reads over 1MB\"\nA: {\"query\": \"events/jdk.FileRead[bytes>1048576]\", \"explanation\": \"Filters file reads\", \"confidence\": 0.98}\n\nQ: \"count GC events\"\nA: {\"query\": \"events/jdk.GarbageCollection | count()\", \"explanation\": \"Counts GC events\", \"confidence\": 0.98}\n\nDECORATOR QUERY EXAMPLES:\n\nQ: \"which methods are causing virtual thread pinning\"\nA: {\"query\": \"events/jdk.ExecutionSample | decorateByTime(jdk.VirtualThreadPinned, fields=duration) | groupBy(stackTrace/frames/0/method/type/name, agg=sum, value=$decorator.duration) | top(10, by=sum)\", \"explanation\": \"Correlates execution samples with pinning events using decorateByTime, groups by method and sums decorator duration field\", \"confidence\": 0.90}\n\nQ: \"which code allocates memory during garbage collection\"\nA: {\"query\": \"events/jdk.ObjectAllocationSample | decorateByTime(jdk.GCPhase, fields=name) | groupBy($decorator.name, agg=sum, value=allocationSize)\", \"explanation\": \"Decorates allocations with GC phase names using temporal overlap\", \"confidence\": 0.90}\n\nQ: \"what was the application doing during long safepoint pauses\"\nA: {\"query\": \"events/jdk.ExecutionSample | decorateByTime(jdk.SafepointBegin, fields=operation,duration) | groupBy($decorator.operation, agg=avg, value=$decorator.duration)\", \"explanation\": \"Correlates execution samples with safepoints\", \"confidence\": 0.90}\n\nQ: \"which monitors have cascading wait queues\"\nA: {\"query\": \"events/jdk.JavaMonitorWait | groupBy(monitorClass/name, agg=sum, value=duration) | top(10, by=sum)\", \"explanation\": \"Groups monitor waits by class and sums wait duration\", \"confidence\": 0.95}\n\nQ: \"which threads are blocked on I/O operations the most\"\nA: {\"query\": \"events/jdk.ThreadPark | decorateByTime(jdk.FileRead, fields=path) | groupBy(eventThread/javaName, agg=sum, value=duration) | top(10, by=sum)\", \"explanation\": \"Decorates thread park events with file read context\", \"confidence\": 0.90}\n\nQ: \"correlate monitor inflation events with contention\"\nA: {\"query\": \"events/jdk.JavaMonitorEnter | decorateByTime(jdk.JavaMonitorInflate, fields=monitorClass) | groupBy($decorator.monitorClass, agg=count)\", \"explanation\": \"Uses decorateByTime to join monitor events temporally\", \"confidence\": 0.90}\n\nQ: \"show pinned thread stack traces with duration over 100ms\"\nA: {\"query\": \"events/jdk.VirtualThreadPinned[duration>100000000]\", \"explanation\": \"Filters pinned thread events by duration\", \"confidence\": 0.95}\n\nQ: \"show allocation hot spots during young generation GC\"\nA: {\"query\": \"events/jdk.ObjectAllocationSample | decorateByTime(jdk.GarbageCollection, fields=gcId,name) | groupBy(objectClass/name, agg=sum, value=bytes) | top(10, by=sum)\", \"explanation\": \"Decorates allocations with GC events including name field\", \"confidence\": 0.90}\n\nQ: \"which threads allocate the most during GC phases\"\nA: {\"query\": \"events/jdk.ObjectAllocationSample | decorateByTime(jdk.GCPhase, fields=name) | groupBy(eventThread/javaName, agg=sum, value=bytes) | top(10, by=sum)\", \"explanation\": \"Decorates allocations with GC phases and groups by thread\", \"confidence\": 0.90}\n\nQ: \"find operations causing safepoint delays over 50ms\"\nA: {\"query\": \"events/jdk.SafepointBegin[duration>50000000] | groupBy(operation, agg=count)\", \"explanation\": \"Filters safepoints and groups by operation type\", \"confidence\": 0.95}\n\nQ: \"correlate JIT compilation with safepoint duration\"\nA: {\"query\": \"events/jdk.SafepointBegin | decorateByTime(jdk.Compilation, fields=method) | groupBy($decorator.method, agg=sum, value=duration)\", \"explanation\": \"Decorates safepoints with compilation method field\", \"confidence\": 0.90}\n\nQ: \"show thread starvation caused by lock contention\"\nA: {\"query\": \"events/jdk.JavaMonitorEnter[duration>100000000] | groupBy(eventThread/javaName, agg=count)\", \"explanation\": \"Filters long monitor enter events and groups by thread\", \"confidence\": 0.95}\n\nQ: \"correlate socket reads with thread parking duration\"\nA: {\"query\": \"events/jdk.SocketRead | decorateByTime(jdk.ThreadPark, fields=duration) | groupBy(address, agg=avg, value=$decorator.duration)\", \"explanation\": \"Decorates socket reads with thread park duration\", \"confidence\": 0.90}\n\nQ: \"detect blocking I/O causing thread starvation\"\nA: {\"query\": \"events/jdk.ThreadPark[duration>10000000] | decorateByTime(jdk.SocketRead, fields=bytesRead) | groupBy(eventThread/javaName, agg=count)\", \"explanation\": \"Filters long thread parks and decorates with socket read context\", \"confidence\": 0.90}\n\nCRITICAL DECORATOR SYNTAX RULES:\n\n1. Syntax: decorateByTime(EventType, fields=field1,field2) - fields parameter REQUIRED\n2. Decorator field access: MUST use $decorator.fieldName ($ prefix is REQUIRED)\n3. Decorator fields work in: groupBy keys, agg values, top sorting\n4. decorateByTime joins events that overlap in time on same thread\n5. DO NOT use filters inside decorateByTime - filter the primary events instead\n6. Examples: $decorator.duration, $decorator.name, $decorator.monitorClass\n\nCOMMON MISTAKES TO AVOID:\n\nWRONG: decorateByTime(jdk.Type) - missing fields parameter\nCORRECT: decorateByTime(jdk.Type, fields=field1)\n\nWRONG: groupBy(decorator.name) - missing $ prefix\nCORRECT: groupBy($decorator.name)\n\nWRONG: decorate(jdk.Type, fields=...) - wrong operator name\nCORRECT: decorateByTime(jdk.Type, fields=...)\n\nWRONG: decorateByTime(jdk.Type[filter], fields=...) - filters not supported inside decorateByTime\nCORRECT: events/jdk.PrimaryType[filter] | decorateByTime(jdk.Type, fields=...)\n\nKEY FIELD RULES:\n- ExecutionSample: Use 'sampledThread/javaName' for thread field\n- ObjectAllocationSample: Use 'eventThread/javaName', 'bytes' for memory, 'weight' for pressure\n- Virtual threads: jdk.VirtualThreadPinned event type for Java 21+\n- GC phases: jdk.GCPhase for phase-level analysis\n- Safepoints: jdk.SafepointBegin with 'operation' field\n- Network: jdk.SocketRead/SocketWrite with bytesRead/bytesWritten\n- File I/O: jdk.FileRead (bytes), jdk.FileWrite (bytesWritten)"
      }
    }
  ]
}
